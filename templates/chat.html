{% extends "base.html" %}
{% block head %}
<title>Chat Example</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
<script type="text/javascript" src='//code.jquery.com/jquery-1.4.2.min.js'></script>
<script type="text/javascript" src='//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js'></script>
<script type="text/javascript">
    var socket;
    $(document).ready(function() {
        // getstrongwith.me
        //socket = io.connect('http://' + document.domain + ':' + 5004 + '/chat');
        socket = io.connect('http://getstrongwith.me:5004/chat')

        socket.on('connect', function() {
            //io.socket.clients(room)
            socket.emit('join', {});
            console.log('socket connected');
        });
        socket.on('status', function(data) {
            $('#chat').val($('#chat').val() + '<' + data.msg + '>\n');
            $('#chat').scrollTop($('#chat')[0].scrollHeight);
        });
        socket.on('message', function(data) {
            $('#chat').val($('#chat').val() + data.msg + '\n');
            $('#chat').scrollTop($('#chat')[0].scrollHeight);
        });
        $('#send').click(function(e) {
                text = $('#text').val();
                $('#text').val('');
                socket.emit('text', {msg: text});
        });
    });

    function leave_room() {
        socket.emit('left', {}, function() {
            socket.disconnect();
            window.location.href = '{{url_for("index") }}';
        })
    }
</script>
{% endblock %}
{% block body %}

        <div class='chatwindow'>
            <h2 id='room'>Chatting with {{ session['recipient_name'] }}</h2><br>
            <textarea id='chat' cols='70' rows='10' placeholder='No messages yet...'></textarea><br>
            <input type='text' id='text' size='60' placeholder='Enter message here'>
            <button type='button' id='send' class='btn btn-success'>SEND</button><br><br>
            <center> <button type='button' class='btn btn-danger' onclick=leave_room()>Leave Chat</button></center>
        </div>






{% endblock %}